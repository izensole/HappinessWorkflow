---
title: "Analytics Workflow for World Happiness Data"
author: Molly Izenson
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Overview of the analysis and necessary references

This data comes from the 2020 World Happiness Report, a survey that ranks 156 countries on how happy their citizens perceive themselves to be. 

## put references here

### Goal of Analysis
The goal of this analysis is to determine which factors have a statistically significant impact on a country's happiness, using the variable, Life Ladder, as y. This analysis is to be used by the World Health Organization (WHO) to better understand why and help countries who may have low levels of happiness. This analysis should provide insight to the WHO so that they can institute new policies that might, in the long run, affect happiness. It is crucial that this analysis is reusable in order for the audience to use the knowledge. 

### Description of Data
 * __The Happiness Score__ or subjective well-being (variable = life ladder)
 * __GDP per capita__ (variable = Log gdp per capita)
 * __Healthy Life Expectancy__ (variable = Healthy life expectancy at birth)
 * __Social Support__ or having someone to count on in times of trouble (variable = Social Support)
 * __Freedom__ to make life choices (variable = Freedom to make life choices)
 * __Generosity__ or donating money to charity in the past month (variable = Generosity)
 * __Corruption Perception__, both within government and businesses (variable = Perceptions of Corruption)
 * __Positive Affect__ (average of happiness, laugh, and enjoyment)
 * __Negative Affect__ (average of worry, sadness, anger)
 * __GINI of household income__ (variable = giniIncGallup)
 * __GINI index__ from the World Bank (variable = giniIncWB)
 * __Average GINI index__ from the World Bank (variable = giniIncWBavg)
 
### Loading in Packages

```{r}
library(pacman)
#p_load(put packages here)
```
The package _ is used to
The package _ is used to

### Loading Data into R
```{r}
happy<-read.csv("HappyData.csv")

```

# Introducing the Data

```{r}
library(DataExplorer)
introduce(happy)
```

# Missing Data
```{r}
plot_missing(happy)
str(happy)
```
As you can see from the chart above and the data summary, there are 12,297 missing values in this data set.The plot above shows the percentages of missing data for each variable, determining if it is okay to keep it in, or if it should be removed.

The Happiness Report acknowledges these missing values and says they did not use missing value to draw results from the happiness rankings and the regression outputs. However, they did make use of imputation in decomposing a country's average ladder score into components explained by 6 determinants (GDP per person, healthy life expectancy, social support, perceived freedom, generosity, and perception of corruption).

A decision must be made on whether to keep or remove these variables with high percentages of missing values in the analysis. I am going to remove all variables with "Bad" or "Remove" labels.

### Cleaning the Data
The code below removes the 8 varaibles with missing data considered "Bad" or "Remove" from the dataset.

```{r}
library(dplyr)
happy<-select(happy, -Most.people.can.be.trusted..WVS.round.2010.2014, -GINI.index..World.Bank.estimate., -Most.people.can.be.trusted..WVS.round.2005.2009, -Most.people.can.be.trusted..WVS.round.1994.1998, -Most.people.can.be.trusted..WVS.round.1999.2004, -Most.people.can.be.trusted..WVS.round.1989.1993, -Most.people.can.be.trusted..Gallup, -Most.people.can.be.trusted..WVS.round.1981.1984)

```

```{r}
str(happy)
```

```{r}
plot_missing(happy)
```

```{r}
library(DataExplorer)
introduce(happy)
```
Now there are 1385 missing values. 

Impute values:
```{r}
#impute values here:
plot_histogram(happy)

```
Manually create indicators for variables with more than 10% missing. Those varaibles are gini.of.household.income.reported.in.Gallup..by.wp5.year and confidence.in.national.government
```{r}
summary(happy$gini.of.household.income.reported.in.Gallup..by.wp5.year)
happy$M_gini.of.household.income.reported.in.Gallup..by.wp5.year<-as.factor(ifelse(is.na(happy$gini.of.household.income.reported.in.Gallup..by.wp5.year), 1, 0))
```

```{r}
## Imputation
happy$gini.of.household.income.reported.in.Gallup..by.wp5.year[is.na(happy$gini.of.household.income.reported.in.Gallup..by.wp5.year)]<-median(happy$gini.of.household.income.reported.in.Gallup..by.wp5.year, na.rm=TRUE)
summary(happy$gini.of.household.income.reported.in.Gallup..by.wp5.year)
```

Imputation for confidence in national government:
```{r}
summary(happy$Confidence.in.national.government)
happy$M_confidence.in.national.government<-as.factor(ifelse(is.na(happy$Confidence.in.national.government), 1, 0))
```

```{r}
happy$Confidence.in.national.government[is.na(happy$Confidence.in.national.government)]<-median(happy$Confidence.in.national.government, na.rm=TRUE)
summary(happy$Confidence.in.national.government)
```


```{r}
plot_missing(happy)
library(DataExplorer)
introduce(happy)
```
Now there are 824 total missing values.

```{r}
#**correlation plot**

happy_nums<-unlist(lapply(happy, is.numeric))
happy_nums2<-happy[, happy_nums]
str(happy_nums2)

plot(happy_nums2$Confidence.in.national.government, happy_nums2$Democratic.Quality)

```

```{r}
#Skim summary function - another option

#library(skimr)
#skim(happy)

```


## Building the Explanatory Model
```{r}

happy.reg<-lm(Life.Ladder~., data=happy)
#summary(happy.reg)

```

### Visualizations of Model
```{r}

```

#Justification of Model
```{r}

```


### Conclusion of Summary


### address the BVP & how the solution meets the requirements of the customer segment
```{r}

```





